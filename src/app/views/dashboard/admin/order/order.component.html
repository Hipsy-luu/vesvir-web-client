<div class="row">
    <div class="col-lg-4 col-md-4">
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-12">
                        <div class="d-flex no-block align-items-center">
                            <div>
                                <span class="btn btn-circle btn-lg date-bg">
                                    <i class="ti-calendar text-white"></i>
                                </span>
                            </div>
                            <div class="ma-l-40">
                                <h4>Fecha</h4>
                                <h4 class="card-subtitle date-font-col">
                                    {{ utilitiesService.formatDate1( orderDetail.createDate ) }}
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4 col-md-4">
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-12">
                        <div class="d-flex no-block align-items-center">
                            <div>
                                <span class="btn btn-circle btn-lg total-bg">
                                    <i class="ti-money text-white"></i>
                                </span>
                            </div>
                            <div class="ma-l-40">
                                <h4>Total</h4>
                                <h4 class="card-subtitle total-font-col">$ {{ orderDetail.amount.toFixed(2) }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4 col-md-4">
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-12">
                        <div class="d-flex no-block align-items-center">
                            <div>
                                <span class="btn btn-circle btn-lg product-bg">
                                    <i class="ti-shopping-cart text-white"></i>
                                </span>
                            </div>
                            <div class="ma-l-40">
                                <h4>Paquetes</h4>
                                <h4 class="card-subtitle product-font-col">{{totalProducts}}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<div class="card-body">
    <div class="row">
        <div class="card col-sm-12 col-md-7">
            <h4 class="card-title row">
                <div class="col-6 full-left">
                    <i class="fas fa-file-alt ma-r-10"></i>
                    <span class="ma-r-10">Pedido</span>
                    <span class="no-margin genre-label margin-hori-10-5"
                        style=" background-color: #230031;  margin-bottom: 5px; border-color: #3f0058; ">
                        N<sup>o</sup> {{orderDetail.idOrder}}
                    </span>
                </div>
                <div class="col-6 full-centered full-right">
                    <!-- TO DO : implementar la creación del archivo pdf de la orden -->
                    <!-- <button class="btn mr-0 btn-outline-primary button-options ma-15-0 ma-r-10" type="button">
                        <div class="row full-centered font-normal">
                            <i class="fas fa-print ma-r-10"></i>
                            Imprimir pedido
                        </div>
                    </button> -->
                </div>
            </h4>
            <hr class="m-t-0" />
            <div class="card">
                <h5 class="card-title row">
                    <span class="ma-10-30">
                        <i class="fas fa-book ma-r-10"></i>
                        Historial del pedido</span>
                    <span class="no-margin genre-label margin-hori-10-5 no-margin full-centered"
                        style=" background-color: #fafafa;  margin-bottom: 5px; border: solid 1px #3f0058;border-radius: 10px !important; color: #1a1a1a;">
                        {{orderDetail.statusHistorys.length}}
                    </span>
                </h5>
                <div class="card-body p-t-0 p-r-0 no-padding">
                    <div class="chat-box p-r-15">
                        <!-- ITEMS -->
                        <div class="col-12" style="height: calc(100vh - 600px); position: relative;"
                            [perfectScrollbar]="config">
                            <table class="table table-hover">
                                <thead>
                                    <tr class="row">
                                        <th scope="col" class="col-1 full-centered">N<sup>o</sup></th>
                                        <th scope="col" class="col-6 full-left">Estado</th>
                                        <th scope="col" class="col-2 full-left">Usuario</th>
                                        <th scope="col" class="col-2 full-centered">
                                            <!-- <i class="far fa-calendar ma-r-10"></i> -->Fecha</th>
                                        <th scope="col" class="col-1 full-centered" style="font-size: 0.7rem;">Acciones
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- <div >
                                        <div *ngFor='let text of many2' [innerHtml]='text'></div>
                                    </div> -->
                                    <tr class="row" *ngFor='let orderHis of orderDetail.statusHistorys;let i = index'>
                                        <th scope="col" class="col-1 full-centered">
                                            {{orderDetail.statusHistorys.length - i}}
                                        </th>
                                        <th scope="col" class="col-6 full-left" style="font-size: 0.7rem;">
                                            <span>{{orderHis.label}}</span>
                                        </th>
                                        <th scope="col" class="col-2 full-left" style="font-size: 0.7rem;">
                                            {{orderHis.registerUserData}}
                                        </th>
                                        <th scope="col" class="col-2 full-centered" style="font-size: 0.7rem;">
                                            {{ utilitiesService.formatDate1( orderHis.createdAt )}}
                                        </th>
                                        <th scope="col" class="col-1 full-centered">
                                            <!-- <button (click)="resentEmail(orderHis.status)"
                                                class="btn mr-0 btn-outline-secondary" type="button">
                                                <i class="fas fa-share ma-r-10"></i>
                                                Reenviar Email
                                            </button> -->
                                        </th>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-12">
                    <div class="row " style="margin-bottom: 15px;">
                        <div class="col-4">

                        </div>
                        <div class="col-8 ">
                            <button (click)="openAddNewStatus()" class="btn mr-0 btn-outline-primary full-width"
                                style="margin-top: 22px" type="button">
                                <i class="fas fa-plus-square ma-r-10"></i>AÑADIR NUEVO ESTADO
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <hr class="m-t-0" />
            <div class="card">
                <h5 class="card-title row">
                    <span class="ma-10-30">
                        <i class="fas fa-box-open ma-r-10"></i>
                        Envíos</span>
                    <span class="no-margin genre-label margin-hori-10-5 no-margin full-centered"
                        style=" background-color: #fafafa;  margin-bottom: 5px; border: solid 1px #3f0058;border-radius: 10px !important; color: #1a1a1a;">
                        {{orderDetail.shippingPackages.length}}
                    </span>
                </h5>
                <div class="card-body p-t-0 p-r-0 no-padding">
                    <div class="chat-box p-r-15">
                        <!-- ITEMS -->
                        <div class="col-12">
                            <table class="table table-hover">
                                <thead>
                                    <tr class="row">
                                        <th scope="col" class="col-2 full-left">Fecha</th>
                                        <th scope="col" class="col-3 full-left">
                                            <i class="fas fa-building"></i>Proveedor
                                        </th>
                                        <th scope="col" class="col-1 full-centered">
                                            <i class="fas fa-shopping-cart ma-r-10"></i>
                                        </th>
                                        <th scope="col" class="col-2 full-centered">Costo</th>
                                        <th scope="col" class="col-2 full-right fs-0-7">N<sup>o</sup>Seguimiento</th>
                                        <th scope="col" class="col-2 full-right"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- <div >
                                        <div *ngFor='let text of many2' [innerHtml]='text'></div>
                                    </div> -->
                                    <tr *ngFor='let shippingPackage of orderDetail.shippingPackages;let i = index'
                                        class="row">
                                        <th scope="col" class="col-2 full-left fs-0-7">
                                            {{ utilitiesService.formatDate1( shippingPackage.createDate ) }}
                                        </th>
                                        <!-- <th scope="col" class="col full-left">
                                            Fedex
                                        </th> -->
                                        <th scope="col" class="col-3 full-left fs-0-7">
                                            <a [routerLink]="'/dashboard-admin/provider/'+shippingPackage.provider.idUser"
                                                target="_blank">
                                                {{shippingPackage.provider.businessName}}
                                            </a>
                                        </th>
                                        <th scope="col" class="col-1 full-centered">
                                            {{shippingPackage.packageProducts.length}}
                                        </th>
                                        <th scope="col" class="col-2 full-centered fs-0-7">
                                            $ {{shippingPackage.costDelivery.toFixed(2)}}
                                        </th>
                                        <th scope="col" class="col-2 full-right fs-0-7">
                                            <a [href]="shippingPackage.trackingUrl" target="_blank">
                                                {{shippingPackage.trackingNumber}}
                                            </a>
                                        </th>
                                        <th scope="col" class="col-2 full-right">
                                            <button class="btn mr-0 btn-outline-secondary"
                                                (click)="openModalShippingDetails(shippingPackage)" type="button">
                                                <i class="fas fa-share ma-r-10"></i>
                                                Ver
                                            </button>
                                        </th>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- <hr class="m-t-0" /> -->
            <div class="card">
                <h5 class="card-title row">
                    <span class="ma-10-30">
                        <i class="fas fa-hand-holding-usd ma-r-10"></i>
                        Pagos</span>
                    <span class="no-margin genre-label margin-hori-10-5"
                        style=" background-color: #fafafa;  margin-bottom: 5px; border: solid 1px #3f0058;border-radius: 10px !important; color: #1a1a1a;">
                        {{orderDetail.payments.length}}
                    </span>
                </h5>
                <div class="card-body p-t-0 p-r-0 no-padding">
                    <div class="chat-box p-r-15">
                        <!-- ITEMS -->
                        <div class="col-12">
                            <table class="table table-hover">
                                <thead>
                                    <tr class="row">
                                        <th scope="col" class="col-2 full-left">Fecha</th>
                                        <th scope="col" class="col-2 full-left">Método de pago</th>
                                        <th scope="col" class="col-2 full-centered">Plataforma</th>
                                        <th scope="col" class="col-2 full-centered">Importe</th>
                                        <th scope="col" class="col-2 full-centered">Req Factura</th>
                                        <th scope="col" class="col-2 full-centered">Estado Factura</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- <div >
                                    <div *ngFor='let text of many2' [innerHtml]='text'></div>
                                </div> -->
                                    <tr class="row" *ngFor='let paymentDetail of orderDetail.payments'>
                                        <th scope="col" class="col-2 full-left fs-0-7">
                                            {{ utilitiesService.formatDate1(paymentDetail.createDate) }}
                                        </th>
                                        <th scope="col" class="col-2 full-left">
                                            <label *ngIf="paymentDetail.status == 'paid-card'"
                                                class="row no-margin genre-label margin-hori-10-5 fs-0-7"
                                                style=" background-color: #1d3099;  margin-bottom: 5px;">
                                                Tarjeta
                                            </label>
                                            <label *ngIf="paymentDetail.status == 'paid-wallet'"
                                                class="row no-margin genre-label margin-hori-10-5 fs-0-7"
                                                style=" background-color: #1d3099;  margin-bottom: 5px;">
                                                Pago de envío - Wallet
                                            </label>
                                            <label *ngIf="paymentDetail.status == 'Transferencia'"
                                                class="row no-margin genre-label margin-hori-10-5 fs-0-7"
                                                style=" background-color: #2392a1;  margin-bottom: 5px;">
                                                Transferencia
                                            </label>
                                            <label *ngIf="paymentDetail.status == 'Puntos de pago'"
                                                class="row no-margin genre-label margin-hori-10-5 fs-0-7"
                                                style=" background-color: #23a12e;  margin-bottom: 5px;">
                                                Puntos de pago
                                            </label>
                                        </th>
                                        <th scope="col" class="col-2 full-centered fs-0-7">

                                            <span
                                                *ngIf="paymentDetail.status == 'paid-card'">Conekta</span>
                                            <span
                                                *ngIf="paymentDetail.status == 'paid-wallet'">MiEnvio</span>
                                        </th>
                                        <th scope="col" class="col-2 full-centered fs-0-7">
                                            $ {{paymentDetail.amount.toFixed(2)}}
                                        </th>
                                        <th scope="col" class="col full-centered">
                                            <label
                                                *ngIf="paymentDetail.status == 'paid-card' && orderDetail.needInvoice == true"
                                                class="row no-margin genre-label margin-hori-10-5"
                                                style=" background-color: #1d9932;  margin-bottom: 5px;">
                                                SI
                                            </label>
                                            <label
                                                *ngIf="(paymentDetail.status == 'paid-card' && orderDetail.needInvoice == false) || paymentDetail.status == 'paid-wallet'"
                                                class="row no-margin genre-label margin-hori-10-5"
                                                style=" background-color: #2392a1;  margin-bottom: 5px;">
                                                NO
                                            </label>
                                        </th>
                                        <th scope="col" class="col-2 full-centered">
                                            <span
                                                *ngIf="paymentDetail.status == 'paid-card' && orderDetail.needInvoice == true">
                                                <label *ngIf="orderDetail.invoiced == true"
                                                    class="btn mr-0 btn-outline-secondary" type="button">
                                                    <i class="fas fa-check-circle ma-r-10"></i>
                                                    OK
                                                </label>
                                                <button (click)="createInvoice()" *ngIf="orderDetail.invoiced == false"
                                                    class="btn mr-0 btn-outline-secondary" type="button">
                                                    <i class="fas fa-check-circle ma-r-10"></i>
                                                    Crear
                                                </button>
                                            </span>
                                        </th>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- <hr class="m-t-0" /> -->

        </div>
        <div class="card col-sm-12 col-md-5">
            <h4 class="card-title row">
                <div class="col-9 full-left">
                    <i class="fas fa-user ma-r-10"></i>
                    Cliente - <h6 class="no-margin full-centered margin-hori-10-5">
                        {{orderDetail.customer.name}} {{orderDetail.customer.surnames}}</h6>
                </div>
                <div class="col-3 full-right">
                    <span class="no-margin genre-label margin-hori-10-5"
                        style=" background-color: #fafafa;  margin-bottom: 5px; border: solid 1px #3f0058;border-radius: 10px !important; color: #1a1a1a;">
                        N<sup>o</sup> {{orderDetail.customer.idUser}}
                    </span>
                </div>
            </h4>
            <hr class="m-t-0" />
            <div class="card-body">

                <div class="row">
                    <div class="col-lg-6 col-md-12 col-sm-12">
                        <div class="card " style="padding: 15px 18px;font-size: small;">
                            <h5 class="">Correo electrónico</h5>
                            <span>
                                <i class="fas fa-envelope ma-r-10"></i>
                                <a href="mailto:{{orderDetail.customer.email}}"
                                    class="">{{orderDetail.customer.email}}</a>
                            </span>

                            <h5 class="">Cuenta registrada</h5>
                            <span>
                                <i class="fas fa-calendar  ma-r-10"></i>
                                {{ utilitiesService.formatDate1(orderDetail.customer.createDate) }}
                            </span>

                            <h5 class="">Pedidos validos realizados</h5>
                            <span>
                                <span class="no-margin genre-label margin-hori-10-5"
                                    style=" background-color: #2BA8E3 !important;  margin-bottom: 5px; border-color: #3f0058; ">
                                    {{noTotalOrders}}
                                </span>
                            </span>

                            <h5 class="">Total gastado desde su registro</h5>
                            <span>
                                <span class="no-margin genre-label margin-hori-10-5"
                                    style=" background-color: #22c6ab;  margin-bottom: 5px; border-color: #3f0058; ">
                                    $ {{totalPayment.toFixed(2)}}
                                </span>
                            </span>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-12 col-sm-12">
                        <div class="row">
                            <h4 class="">
                                <i class="fas fa-sticky-note ma-r-10"></i>
                                Nota Privada
                            </h4>
                        </div>
                        <div class="row ">
                            <textarea [(ngModel)]="orderDetail.privateNote" rows="8" cols="50" class=""></textarea>
                            <div class="col-12 full-right">
                                <button (click)="updatePrivateNote()"
                                    class="btn mr-0 btn-outline-primary button-options ma-15-0" style="margin-top: 14px;" type="button">
                                    <div class="row full-centered font-normal">
                                        <i class="fas fa-save ma-r-10"></i>
                                        Guardar
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row card">
                    <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
                        <li [ngbNavItem]="1">
                            <a ngbNavLink>
                                <i class="fas fa-truck-moving ma-r-10"></i>
                                Dirección de envió
                            </a>
                            <ng-template ngbNavContent>
                                <div class=" p-r-15" style="position: relative;">
                                    <!-- ITEMS -->
                                    <!-- <div class="row">
                                        <div class="col-12">
                                            <div class="form-group">
                                                <label class="control-label col-form-label">Seleccione la dirección de envió</label>
                                                <div ngbDropdown class="">
                                                    <button
                                                      class="form-control"
                                                      id="dropdownUserType"
                                                      ngbDropdownToggle
                                                    >
                                                        <span>1 - Avenida 26 Pte, Delicias</span>
                                                    </button>
                                                    <div ngbDropdownMenu aria-labelledby="dropdownUserType" class="full-width">
                                                        <button ngbDropdownItem >1 - Avenida 26 Pte, Delicias</button>
                                                        <button ngbDropdownItem >2 - Calle villa de lira, Chihuahua</button>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                        </div>
                                    </div> -->
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span>Nombre
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idnamem"
                                                    placeholder="Nombre de la persona que recibe"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.name}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span>Apellidos
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idsurm"
                                                    placeholder="Escriba sus apellidos"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.surnames}}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-12">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span>Calle
                                                </label>
                                                <!-- <textarea type="text" class="form-control" id="iddirm"
                                                    placeholder="Escriba la calle aquí"></textarea> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.street}}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span>Teléfono
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idtelm"
                                                    placeholder="Escriba su teléfono"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.phone}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span> No Interior
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idintm"
                                                    placeholder="Numero interior"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.number}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span> No Exterior
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idnoem"
                                                    placeholder="Numero exterior"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.extNumber}}
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span> Estado
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idestm"
                                                    placeholder="Nombre del estado"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.state}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span> Ciudad
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idcium"
                                                    placeholder="Nombre de la ciudad"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.city}}
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span> Colonia
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idcolm"
                                                    placeholder="Nombre de la colonia"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.colony}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <span style="color: red;">*</span> Código Postal
                                                </label>
                                                <!-- <input type="text" class="form-control" id="idcodm"
                                                    placeholder="Código postal"> -->
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.shippingAddress.postalCode}}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <div class="row ">
                                        <div class="col-12 full-right">
                                            <button class="btn mr-0 btn-outline-primary button-options ma-15-0"
                                                type="button">
                                                <div class="row full-centered font-normal">
                                                    <i class="fas fa-save ma-r-10"></i>
                                                    Guardar
                                                </div>
                                            </button>
                                        </div>
                                    </div> -->
                                </div>
                            </ng-template>
                        </li>
                        <li *ngIf="orderDetail.needInvoice == true" [ngbNavItem]="2">
                            <a ngbNavLink>
                                <i class="far fa-file-alt  ma-r-10"></i>
                                Datos Facturación
                            </a>
                            <ng-template ngbNavContent>
                                <div class=" p-r-15" style="position: relative;">
                                    <!-- ITEMS -->
                                    <div class="row">
                                        <div class="col-sm-12 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Razón social
                                                </label>
                                                <label type="text" class="form-control" id="idraz">
                                                    {{orderDetail.customer.businessName}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> RFC
                                                </label>
                                                <label type="text" class="form-control" id="idrfc">
                                                    {{orderDetail.customer.rfc}}</label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Teléfono
                                                </label>
                                                <label type="text" class="form-control" id="idtel3">
                                                    {{orderDetail.customer.phoneBilling}}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Correo Electrónico
                                                </label>
                                                <label type="text" class="form-control" id="inemal2">
                                                    {{orderDetail.customer.emailBilling}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Estado
                                                </label>
                                                <label type="text" class="form-control" id="inedo2">
                                                    {{orderDetail.customer.state}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-4">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Ciudad
                                                </label>
                                                <label type="text" class="form-control" id="incity2">
                                                    {{orderDetail.customer.city}}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-6 col-md-2">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Código postal
                                                </label>
                                                <label type="text" class="form-control" id="incod2">
                                                    {{orderDetail.customer.postalCode}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-2">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Colonia
                                                </label>
                                                <label type="text" class="form-control" id="incol2">
                                                    {{orderDetail.customer.colony}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-2">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Numero
                                                </label>
                                                <label type="text" class="form-control" id="innumber">
                                                    {{orderDetail.customer.number}}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-6 col-md-6">
                                            <div class="form-group">
                                                <label class="control-label form-label">
                                                    <!-- <span style="color: red;">*</span> --> Calle
                                                </label>
                                                <label type="text" class="form-control" id="instreet">
                                                    {{orderDetail.customer.street}}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                        </li>
                    </ul>

                    <div [ngbNavOutlet]="nav" class="mt-2"></div>
                </div>


                <div class="row">
                    <div class="col-12  per-card">
                        <div class="row">
                            <div class="col-7 full-right">
                                <h5>Productos</h5>
                            </div>
                            <div class="col-5 full-right">
                                <h5>$ {{ orderDetail.amount.toFixed(2) }}</h5>
                            </div>
                        </div>
                        <hr class="m-t-0" />
                        <div class="row">
                            <div class="col-7 full-right">
                                <h5>Envió</h5>
                            </div>
                            <div class="col-5 full-right">
                                <h5>$ {{shippingPackagesTotal.toFixed(2)}}</h5>
                            </div>
                        </div>
                        <hr class="m-t-0" />
                        <div class="row">
                            <div class="col-7 full-right">
                                <h5>Total</h5>
                            </div>
                            <div class="col-5 full-right">
                                <h5>$ <strong>{{(shippingPackagesTotal + orderDetail.amount ).toFixed(2)}}</strong></h5>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-6 full-left">
            <button (click)="backClicked()" class="btn mr-0 btn-outline-secondary button-options"
                type="button">
                <div class="row full-centered">
                    <i class="fas fa-arrow-circle-left"></i>
                </div>
                <div class="row full-centered font-normal">
                    Regresar
                </div>
            </button>
        </div>
        <div class="col-6 full-right">
            <!-- <button class="btn mr-0 btn-outline-primary button-options" type="button">
                <div class="row full-centered">
                    <i class="fas fa-save"></i>
                </div>
                <div class="row full-centered font-normal">
                    Guardar
                </div>
            </button> -->
        </div>
    </div>
</div>

<ng-template #modalNewState let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Nuevo Status de la Orden</h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-sm-12 col-md-6">
                <div class="form-group">
                    <label for="idnamem" class="control-label col-form-label">Fecha : </label>
                    <label type="text" class="form-control"
                        id="idraz">{{ utilitiesService.formatDate1(newStatusSelected.createdAt) }}</label>
                </div>
            </div>
            <div class="col-sm-12 col-md-6">
                <div class="form-group">
                    <label for="idsurm" class="control-label col-form-label">Por :</label>
                    <label type="text" class="form-control" id="idraz">{{newStatusSelected.registerUserData}}</label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-12">
                <div class="form-group">
                    <label class="control-label form-label">
                        <span style="color: red;">*</span> Descripción técnica
                    </label>
                    <input [(ngModel)]="newStatusSelected.label" type="text" required class="form-control" id="id-dest"
                        placeholder="Descripción detallada del estado actual">
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12 col-md-12">
                <div class="form-group">
                    <label class="control-label form-label">
                        <span style="color: red;">*</span> Descripción para el Cliente
                    </label>
                    <input [(ngModel)]="newStatusSelected.descriptionForUser" type="text" required class="form-control"
                        id="id-desu" placeholder="Descripción corta del estado actual">
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button (click)="modal.close('Save click');" class="btn btn-danger button-reset " type="button">
            <div class="row full-centered font-normal">
                <i class="fas fa-window-close ma-0-10"></i> Cancelar
            </div>
        </button>
        <button (click)="saveNewStatus()" [disabled]="newStatusSelected.label.length < 5 ||
            newStatusSelected.descriptionForUser.length < 5" class="btn btn-success button-reset " type="button">
            <div class="row full-centered font-normal">
                <i class="fas fa-save ma-0-10"></i>Añadir
            </div>
        </button>

        <!--  <button (click)="modal.close('Save click');" class="btn mr-0 btn mr-0 btn-primary button-reset " type="button">
            <div class="row full-centered font-normal">
                <span class="ma-0-10">
                    Aceptar
                </span>
            </div>
        </button> -->
        <!-- <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Save</button> -->
    </div>
</ng-template>


<!-- Modal Direction -->
<ng-template #modalShippingDetails let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Información del Envió
            {{selectedShippingPackage.idShippingPackage}} -
            {{ utilitiesService.formatDate1( selectedShippingPackage.createDate )}} </h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <ul ngbNav #nav="ngbNav" [(activeId)]="activeModal" class="nav-tabs">
            <li [ngbNavItem]="1">
                <a ngbNavLink>
                    <!-- <i class="fas fa-truck-moving ma-r-10"></i>
                    Productos en el paquete -->
                    <h5 class="card-title row">
                        <span class="ma-10-30">
                            <i class="fas fa-shopping-cart ma-r-10"></i>
                            Productos</span>
                        <span class="no-margin genre-label margin-hori-10-5 no-margin full-centered"
                            style=" background-color: #fafafa;  margin-bottom: 5px; border: solid 1px #3f0058;border-radius: 10px !important; color: #1a1a1a;">
                            {{selectedShippingPackage.packageProducts.length}}
                        </span>
                    </h5>
                </a>
                <ng-template ngbNavContent>
                    <div class=" p-r-15" style="position: relative;">
                        <div class="card">
                            <!-- <h5 class="card-title row">
                                <span class="ma-10-30">
                                    <i class="fas fa-shopping-cart ma-r-10"></i>
                                    Productos</span>
                                <span class="no-margin genre-label margin-hori-10-5 no-margin full-centered"
                                    style=" background-color: #fafafa;  margin-bottom: 5px; border: solid 1px #3f0058;border-radius: 10px !important; color: #1a1a1a;">
                                    {{selectedShippingPackage.packageProducts.length}}
                                </span>
                            </h5> -->
                            <div class="card-body p-t-0 p-r-0 no-padding">
                                <div class="chat-box p-r-15">
                                    <div class="col-12" style="height: calc(100vh - 500px); position: relative;" [perfectScrollbar]="config">
                                        <table class="table table-hover" >
                                            <thead>
                                                <tr class="row">
                                                    <th scope="col" class="col-1 full-centered">ID</th>
                                                    <th scope="col" class="col-1 full-centered">Imagen</th>
                                                    <th scope="col" class="col full-left">Nombre</th>
                                                    <th scope="col" class="col full-centered">Precio U</th>
                                                    <th scope="col" class="col-1 full-centered">Cantidad</th>
                                                    <th scope="col" class="col full-centered">Estado</th>
                                                    <th scope="col" class="col-2 full-centered">Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="row" *ngFor="let product of selectedShippingPackage.packageProducts">
                                                    <th scope="col" class="col-1 full-centered">{{product.idSoldProduct}}
                                                    </th>
                                                    <th scope="col" class="col-1 full-centered">
                                                        <img *ngIf="product.product.images.length != 0" [src]="apiDataService.baseURL +
                                                        'uploads/product-image/' + product.product.images[0].idProduct + '/' + product.product.images[0].idProductImage" class="mr-2" style="width: 40px;" />
                                                        <img *ngIf="product.product.images.length == 0" src="/assets/images/no-image.png" class="mr-2" style="width: 40px;" />
                                                    </th>
                                                    <th scope="col" class="col full-left fs-0-7">
                                                        {{product.name}}
                                                    </th>
                                                    <th scope="col" class="col full-centered ">
                                                        {{product.price.toFixed(2)}}
                                                    </th>
                                                    <th scope="col" class="col-1 full-centered">
                                                        {{product.quantity}}
                                                    </th>
                                                    <th scope="col" class="col full-centered">
                                                        <label *ngIf="product.product.deleted == true"
                                                            class="row no-margin genre-label margin-hori-10-5"
                                                            style="background-color: #b12d1c; margin-bottom: 5px;">
                                                            Borrado
                                                        </label>
                                                        <label *ngIf="product.product.activated == true"
                                                            class="row no-margin genre-label margin-hori-10-5"
                                                            style="background-color: #29852e; margin-bottom: 5px;">
                                                            Activado
                                                        </label>
                                                        <label *ngIf="product.product.activated == false"
                                                            class="row no-margin genre-label margin-hori-10-5"
                                                            style="background-color: #1c44b1; margin-bottom: 5px;">
                                                            Pausado
                                                        </label>
                                                    </th>
                                                    <th scope="col" class="col-2 full-centered">
                                                        $ {{(product.quantity * product.price).toFixed(2)}}
                                                    </th>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </li>
            <li [ngbNavItem]="2">
                <a ngbNavLink>
                    <!-- <i class="far fa-file-alt  ma-r-10"></i>
                    Información del Envio -->
                    <h5 class="card-title row">
                        <span class="ma-10-30">
                            <i class="far fa-file-alt  ma-r-10"></i>
                            Información del Envio
                        </span>
                    </h5>
                </a>
                <ng-template ngbNavContent>
                    <div class=" p-r-15" style="position: relative;">
                        <!-- ITEMS -->
                        <!--  <hr class="m-t-0" /> -->
                        <div class="card">
                            <h5 class="card-title row">
                                <span class="ma-10-30">
                                    <i class="fas fa-box-open"></i>
                                    Paquete</span>
                            </h5>
                            <div class="card-body p-t-0 p-r-0 no-padding">
                                <div class="chat-box p-r-15">
                                    <!-- ITEMS -->
                                    <div class="col-12">
                                        <div class="row">
                                            <div class="col-sm-12 col-md-3">
                                                <div class="form-group">
                                                    <label for="idnamem"
                                                        class="control-label col-form-label">Ancho</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{ selectedShippingPackage.width }} cm</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-3">
                                                <div class="form-group">
                                                    <label for="idsurm" class="control-label col-form-label">Alto
                                                        proveedor</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{selectedShippingPackage.height}} cm</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-3">
                                                <div class="form-group">
                                                    <label for="idsurm"
                                                        class="control-label col-form-label">Profundidad</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{selectedShippingPackage.length}} cm</label>
                                                </div>
                                            </div>

                                            <div class="col-sm-12 col-md-3">
                                                <div class="form-group">
                                                    <label for="idsurm"
                                                        class="control-label col-form-label">Peso</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{selectedShippingPackage.weight}} Kg</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr class="m-t-0" />
                        <div class="card">
                            <h5 class="card-title row">
                                <span class="ma-10-30">
                                    <i class="fas fa-people-carry"></i>
                                    Transportista</span>
                            </h5>
                            <div class="card-body p-t-0 p-r-0 no-padding">
                                <div class="chat-box p-r-15">
                                    <!-- ITEMS -->
                                    <div class="col-12">
                                        <div class="row">
                                            <div class="col-sm-12 col-md-4">
                                                <div class="form-group">
                                                    <label for="idnamem"
                                                        class="control-label col-form-label">Transportista</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{ selectedShippingPackage.carrier }}</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-4">
                                                <div class="form-group">
                                                    <label for="idsurm" class="control-label col-form-label">Tiempo de
                                                        entrega</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{selectedShippingPackage.durationTerms}}</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-4">
                                                <div class="form-group">
                                                    <label for="idsurm" class="control-label col-form-label">Costo de
                                                        envio</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">$ {{selectedShippingPackage.costDelivery.toFixed(2)}}</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-12 col-md-4">
                                                <div class="form-group">
                                                    <label for="idnamem" class="control-label col-form-label">Código de
                                                        rastreo</label>
                                                    <label type="text" class="form-control"
                                                        id="idratn">{{ selectedShippingPackage.trackingNumber }}</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-4">
                                                <div class="form-group">
                                                    <label for="idsurm" class="control-label col-form-label">Url de
                                                        rastreo</label>
                                                    <a type="text" class="form-control"
                                                        [href]="selectedShippingPackage.trackingUrl" target="_blank"
                                                        id="idrtu">{{selectedShippingPackage.trackingUrl}}</a>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-4">
                                                <div class="form-group">
                                                    <label for="idsurm" class="control-label col-form-label">Etiqueta de
                                                        la Guiá</label>
                                                    <a type="text" class="form-control"
                                                        [href]="selectedShippingPackage.trackingLabelUrl"
                                                        target="_blank"
                                                        id="idtul">{{selectedShippingPackage.trackingLabelUrl}}</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr class="m-t-0" />
                        <div class="card">
                            <h5 class="card-title row">
                                <span class="ma-10-30">
                                    <i class="fas fa-database"></i>
                                    MI Envio API</span>
                            </h5>
                            <div class="card-body p-t-0 p-r-0 no-padding">
                                <div class="chat-box p-r-15">
                                    <!-- ITEMS -->
                                    <div class="col-12">
                                        <div class="row">
                                            <div class="col-sm-12 col-md-3">
                                                <div class="form-group">
                                                    <label for="idnamem" class="control-label col-form-label">Id
                                                        Compra</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{ selectedShippingPackage.idMiEnvioPurchase }}</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-3">
                                                <div class="form-group">
                                                    <label for="idsurm" class="control-label col-form-label">Id
                                                        dirección
                                                        proveedor</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{selectedShippingPackage.idMiEnvioDirectionProvider}}</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-md-3">
                                                <div class="form-group">
                                                    <label for="idsurm" class="control-label col-form-label">Id Pago
                                                        Envio</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{selectedShippingPackage.idMiEnvioPurchasePaymentId}}</label>
                                                </div>
                                            </div>

                                            <div class="col-sm-12 col-md-3">
                                                <div class="form-group">
                                                    <label for="idsurm" class="control-label col-form-label">Id de
                                                        envio</label>
                                                    <label type="text" class="form-control"
                                                        id="idraz">{{selectedShippingPackage.idMiEnvioShipments}}</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </li>
        </ul>

        <div [ngbNavOutlet]="nav" class="mt-2"></div>

    </div>
    <div class="modal-footer">
        <button (click)="modal.close('Save click');" class="btn mr-0 btn mr-0 btn-primary button-reset " type="button">
            <div class="row full-centered font-normal">
                <!-- <i class="fas fa-window-close ma-0-10"></i> -->
                <span class="ma-0-10">
                    Aceptar
                </span>
            </div>
        </button>
        <!-- <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Save</button> -->
    </div>
</ng-template>